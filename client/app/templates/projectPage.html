<project-nav></project-nav>

<section class="carousel">
    <div class="carousel-inner"><img ng-src="{{project.image}}"></div>
</section>

<section>
	<div class="container">
	    <div class="row section project">
            <div class="span8 project-information">
                <div>
                    <h2>Project:</h2>

                    <h3 class="project-title">{{project.title}}</h3>
                </div>

                <div>
                    <h2>The Problem:</h2>

                    <p ng-bind-html-unsafe="project.problem">{{project.problem}}</p>
                </div>

                <div>
                    <h2>The Action:</h2>

                    <p ng-bind-html-unsafe="project.action">{{project.action}}</p>
                </div>
            </div>

            <div class="span4">
                <div class="callout">
                    <div class="fist-small"></div>
                        <p><span>{{users.length | number}}</span> Taking Action</p>
                    </div>
                    
                <div>
                <form novalidate ng-show="!loggedUser" name="signPetition" class="signPetition" ng-submit="signPledge()">
                            
                    <div form-group form="signPetition">
                    
                        <label for="firstName">First Name *</label>
                        <input form-field ng-blur="Validator.validateField(signPetition.firstName, signPetition)" required type="text" ng-model="signer.firstName" id="firstName" name="firstName" placeholder="First Name" value="" />
                        
                        <div ng-show="signPetition.FacultyErrors.firstName" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.firstName}}
                        </div>

                        <label for="lastName">Last Name *</label>
                        <input form-field ng-blur="Validator.validateField(signPetition.lastName, signPetition)" required type="text" ng-model="signer.lastName" id="lastName" name="lastName" placeholder="Last Name" value="" />
                        
                        <div ng-show="signPetition.FacultyErrors.lastName" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.lastName}}
                        </div>
                        
                        <label for="email">Email *</label>
                        <input form-field ng-blur="Validator.validateField(signPetition.email, signPetition)" required type="text" ng-model="signer.email" id="email" name="email" placeholder="Email" value="" />
                        
                        <div ng-show="signPetition.FacultyErrors.email" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.email}}
                        </div>
                        
                        <div class="row">
	                        <div class="span3">
		                        <label for="city">City *</label>
                            <input form-field ng-blur="Validator.validateField(signPetition.city, signPetition)" required type="text" id="city" ng-model="signer.city" name="city" placeholder="City" value="" />
                            
                            <div ng-show="signPetition.FacultyErrors.city" class="alert alert-error alert-tooltip">
                                {{signPetition.FacultyErrors.city}}
                            </div>
	                        </div>
	                        <div class="span1">
		                        <label for="state">State *</label>                        
                                <select form-field class="input-block" name="state" id="state" ng-model="signer.state" ng-options="state.abbreviation as state.name for state in states" ng-blur="Validator.validateField(signPetition.state, signPetition)" required></select>
                        
                                <div ng-show="signPetition.FacultyErrors.state" class="alert alert-error alert-tooltip">
                                    {{signPetition.FacultyErrors.state}}
                                </div>
	                        </div>
                        </div>
 
                        <label for="zipCode">Zip Code *</label>
                        <input form-field ng-blur="Validator.validateField(signPetition.zipCode, signPetition)" required type="text" id="zipCode" ng-model="signer.zipCode" name="zipCode" placeholder="Zip Code" value="" />
                        
                        <div ng-show="signPetition.FacultyErrors.zipCode" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.zipCode}}
                        </div>
        
                        <p>* Required Information</p>

                    </div>
                                                
                    <button type="submit" ng-disabled="signPetition.$invalid" class="btn btn-primary pull-right">Sign the Pledge</button>
                    
                </form>
                
                <button ng-show="loggedUser && !performedAction"class="btn-block btn" ng-click="performedAction || signPledge()">Sign Me!</button>
                
                <h2 ng-show="performedAction">You've signed the pledge, share below</h2>
                
            </div>

	    </div><!-- End row -->
    </div><!-- .container -->
	</div>
	<!-- When we have a rallies-user table or property, add ng-class="user.attending?" or some such -->
    <div class="container stretch">
        <div ng-click="performedAction || signPledge()" ng-show="loggedUser">
            <div banner="" banner-type="action" banner-disabled="performedAction" banner-action="Sign the Pledge" banner-action-fulfilled="Signed"></div>
        </div>
        <div banner-halves=""></div>
    </div>
    
	<div class="container">
	    <div class="row section section-last">
	        <div class="span12">
	            <h2>Rootstrikers Taking Action:</h2>
	
                <div class="row">
	
    	            <div class="pill span4">
    	                <h3>{{users.length | number}}</h3>
    	
    	                <h2>Rootstrikers</h2>
    	            </div>
    	
    	            <gravatar-image
                        ng-repeat="user in users"
                        data-email="user.user_id.email"
                        data-size="120"
                        data-rating="pg"
                        data-default="404"
                        data-secure="true"
                        class="avatar-circular span2">
                    </gravatar-image>
                
                </div>
                
	        </div>
	    </div>

	</div><!-- .container -->        
</section>
