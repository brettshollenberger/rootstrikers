<project-nav></project-nav>

<section class="carousel">
    <div class="carousel-inner"><img ng-src="{{project.image}}"></div>
</section>

<section>
	<div class="container">
	    <div class="row section project">
            <div class="span8 project-information">
                <div>
                    <h2>Campaign</h2>

                    <h3 class="project-title">{{project.title}}</h3>
                </div>

                <div ng-hide="isContentFromOldSite(project)">
                    <h2>The Problem</h2>

                    <p ng-bind-html-unsafe="project.problem">{{project.problem}}</p>
                </div>

                <div ng-hide="isContentFromOldSite(project)">
                    <h2>The Action</h2>

                    <p ng-bind-html-unsafe="project.action">{{project.action}}</p>
                </div>

                 <div ng-show="isContentFromOldSite(project)">
                    <p ng-bind-html-unsafe="project.body">{{project.body}}</p>
                </div>
            </div>

            <div class="span4" ng-show="isContentFromOldSite(project)">
                <img src="app/images/campaigncomplete@2x.png">
            </div>

            <div class="span4" ng-hide="isContentFromOldSite(project)">

                <div class="callout">
                
                    <div>
                        <div class="fist-small"></div>
                        <p><span>{{users.length | number}}</span> Taking Action</p>
                    </div>
                    
                    <!-- Status Bar for percent actions completed -->
                    <div class="progress-bar">
                        <div class="progress">
                            <div class="bar" style="width: {{users.length / project.actionsNeeded * 100}}%;"></div>
                        </div>
                        <p class="text-right" ng-hide="!project.actionsNeeded"><span>{{project.actionsNeeded | number}}</span> Needed</p>
                    </div>
                
                <div>

                <form novalidate
                    name="signPetition"
                    class="signPetition"
                    ng-show="!performedAction && !loggedUser && !isContentFromOldSite(project) && !signedPledge"
                    ng-submit="signPledge()">
                            
                    <div form-group form="signPetition">
                    
                        <label for="firstName">First Name</label>
                        <input
                            form-field
                            required
                            type="text" name="firstName" id="firstName" placeholder="First Name" value=""
                            ng-blur="Validator.validateField(signPetition.firstName, signPetition)"
                            ng-model="signer.firstName" />
                        
                        <div ng-show="signPetition.FacultyErrors.firstName" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.firstName}}
                        </div>

                        <label for="lastName">Last Name</label>
                        <input
                            form-field
                            required
                            type="text" name="lastName" id="lastName" placeholder="Last Name" value=""
                            ng-blur="Validator.validateField(signPetition.lastName, signPetition)"
                            ng-model="signer.lastName" />
                        
                        <div ng-show="signPetition.FacultyErrors.lastName" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.lastName}}
                        </div>
                        
                        <label for="email">Email</label>
                        <input
                            form-field
                            required
                            type="text" name="email" id="email" placeholder="Email" value=""
                            ng-blur="Validator.validateField(signPetition.email, signPetition)"
                            ng-model="signer.email" />
                        
                        <div ng-show="signPetition.FacultyErrors.email" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.email}}
                        </div>
 
                        <label for="zipCode">Zip Code</label>
                        <input
                            form-field
                            required
                            type="text" name="zipCode" id="zipCode" placeholder="Zip Code" value=""
                            ng-blur="Validator.validateField(signPetition.zipCode, signPetition)"
                            simple-validate="{zip: {exp: 'Validator.validateZip($value, signPetition.zip)', message: 'Please enter a valid zip code'}}"
                            ng-model="signer.zipCode" />
                        
                        <div ng-show="signPetition.FacultyErrors.zipCode" class="alert alert-error alert-tooltip">
                            {{signPetition.FacultyErrors.zipCode}}
                        </div>
        
                    </div>
                                                
                    <button type="submit" ng-disabled="signPetition.$invalid" class="btn btn-primary pull-right" modal template="app/templates/pledge/thankyou.html">Take Action</button>
                    
                </form>
                
                <button
                    class="btn-block btn"
                    ng-show="loggedUser && !performedAction && !signedPledge"
                    ng-click="performedAction || signPledge()">Sign Me!</button>
                
                <h2 style="line-height:20px;" class="form-thanks" ng-show="performedAction || signedPledge"><i class="icon-ok"></i> You're awesome,<br/><span style="margin-left:33px; color:#888;">thanks for taking action</span></h2>
                
            </div><!-- .span4 -->

	    </div><!-- End row -->
	    
    </div><!-- .container -->
    
	</div>
	</div>
	<!-- When we have a rallies-user table or property, add ng-class="user.attending?" or some such -->
    <div class="stretch">
        <div ng-click="performedAction || signPledge()" ng-show="loggedUser">
            <div banner="" banner-type="action" banner-disabled="performedAction" banner-action="Sign the Pledge" banner-action-fulfilled="Signed"></div>
        </div>
        <div banner-halves=""></div>
    </div>
    
	<div class="container taking-action" ng-hide="isContentFromOldSite(project)">
	    <div class="row section section-last">
	        <div class="span12">
	            <h2>Rootstrikers Taking Action</h2>
	
                <div class="row">
	
    	            <div class="pill span4">
    	                <h3>{{users.length | number}}</h3>
    	
    	                <h2>Rootstrikers</h2>
    	            </div>
    	
    	            <gravatar-image
                        ng-repeat="user in users"
                        data-email="user.user_id.email"
                        data-size="120"
                        data-rating="pg"
                        data-default="404"
                        data-secure="true"
                        class="avatar-circular span2">
                    </gravatar-image>
                
                </div>
                
	        </div>
	    </div>

	</div><!-- .container -->
	
</section>
